<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Image Optimizer UI</title>

    <!-- Tailwind CSS for styling -->

    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Inter font from Google Fonts -->

    <link rel="preconnect" href="https://fonts.googleapis.com">

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Lucide icons for UI elements -->

    <script src="https://cdn.jsdelivr.net/npm/lucide-static@latest/dist/lucide.min.js"></script>

    <style>

        body {

            font-family: 'Inter', sans-serif;

        }

    </style>

</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">



    <div class="w-full max-w-6xl bg-white rounded-2xl shadow-xl p-6 md:p-8 grid grid-cols-1 lg:grid-cols-3 gap-8">

        <!-- Controls Section -->

        <div class="lg:col-span-1 flex flex-col gap-6">

            <div>

                <h1 class="text-2xl font-bold text-gray-800">Image Optimizer</h1>

                <p class="text-gray-500 mt-1">Adjust the settings below to transform the image.</p>

            </div>



            <!-- Dimensions -->

            <div class="space-y-4">

                <h3 class="font-semibold text-gray-700 border-b pb-2">Dimensions</h3>

                <div class="flex items-center gap-4">

                    <div class="flex-1">

                        <label for="width" class="block text-sm font-medium text-gray-600 mb-1">Width (px)</label>

                        <input type="number" id="width" value="800" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">

                    </div>

                     <div class="flex-1">

                        <label for="height" class="block text-sm font-medium text-gray-600 mb-1">Height (px)</label>

                        <input type="number" id="height" value="600" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">

                    </div>

                </div>

                 <div>

                    <input type="checkbox" id="aspectRatio" checked class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">

                    <label for="aspectRatio" class="ml-2 text-sm font-medium text-gray-700">Maintain aspect ratio</label>

                </div>

            </div>



            <!-- Format & Quality -->

            <div class="space-y-4">

                 <h3 class="font-semibold text-gray-700 border-b pb-2">Format & Quality</h3>

                 <div>

                    <label for="format" class="block text-sm font-medium text-gray-600 mb-1">Format</label>

                    <select id="format" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">

                        <option value="image/jpeg">JPEG</option>

                        <option value="image/png">PNG</option>

                        <option value="image/webp" selected>WebP</option>

                    </select>

                </div>

                <div id="quality-container">

                    <label for="quality" class="block text-sm font-medium text-gray-600 mb-1">Quality: <span id="qualityValue">0.9</span></label>

                    <input type="range" id="quality" min="0.1" max="1" step="0.1" value="0.9" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">

                </div>

            </div>

            

            <!-- Actions -->

            <div class="mt-4 flex flex-col gap-3">

                 <button id="processImage" class="w-full flex items-center justify-center gap-2 bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">

                    <i data-lucide="sparkles"></i>

                    Optimize Image

                </button>

                 <a id="downloadLink" class="w-full hidden items-center justify-center gap-2 bg-green-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors" href="#" download="optimized-image.webp">

                    <i data-lucide="download"></i>

                    Download Optimized Image

                </a>

            </div>

        </div>



        <!-- Image Display Section -->

        <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6 items-center">

            <!-- Original Image -->

            <div class="text-center">

                <h2 class="font-semibold text-gray-700 mb-2">Original Image</h2>

                <img id="originalImage" src="https://placehold.co/800x600/3498db/ffffff?text=Sample+Image" crossorigin="anonymous" class="w-full h-auto rounded-lg shadow-md">

                 <p id="originalInfo" class="text-sm text-gray-500 mt-2"></p>

            </div>

            <!-- Optimized Image -->

            <div class="text-center">

                <h2 class="font-semibold text-gray-700 mb-2">Optimized Result</h2>

                <div id="resultContainer" class="w-full h-auto rounded-lg shadow-md bg-gray-200 flex items-center justify-center min-h-[200px]">

                    <img id="resultImage" class="w-full h-auto rounded-lg hidden">

                    <p id="placeholderText" class="text-gray-500">Click 'Optimize Image' to see the result</p>

                </div>

                <p id="resultInfo" class="text-sm text-gray-500 mt-2"></p>

            </div>

        </div>

    </div>



    <script>

        document.addEventListener('DOMContentLoaded', () => {

            // --- ELEMENTS ---

            const originalImage = document.getElementById('originalImage');

            const resultImage = document.getElementById('resultImage');

            const resultContainer = document.getElementById('resultContainer');

            const placeholderText = document.getElementById('placeholderText');

            

            const widthInput = document.getElementById('width');

            const heightInput = document.getElementById('height');

            const aspectRatioCheckbox = document.getElementById('aspectRatio');

            const formatSelect = document.getElementById('format');

            const qualitySlider = document.getElementById('quality');

            const qualityValue = document.getElementById('qualityValue');

            const qualityContainer = document.getElementById('quality-container');



            const processButton = document.getElementById('processImage');

            const downloadLink = document.getElementById('downloadLink');



            const originalInfo = document.getElementById('originalInfo');

            const resultInfo = document.getElementById('resultInfo');



            let originalAspectRatio = 1;



            // --- IMAGE LOADING ---

            const sourceImage = new Image();

            // This is needed to prevent canvas from being "tainted" by a cross-origin image,

            // which would block toDataURL() from working. The image server must support CORS.

            sourceImage.crossOrigin = "anonymous";

            

            sourceImage.onload = () => {

                originalAspectRatio = sourceImage.naturalWidth / sourceImage.naturalHeight;

                widthInput.value = sourceImage.naturalWidth;

                heightInput.value = sourceImage.naturalHeight;

                originalInfo.textContent = `Dimensions: ${sourceImage.naturalWidth}x${sourceImage.naturalHeight}`;

            };

            sourceImage.src = originalImage.src; // Set source from the visible image



            // --- EVENT LISTENERS ---

            processButton.addEventListener('click', optimizeImage);



            qualitySlider.addEventListener('input', () => {

                qualityValue.textContent = qualitySlider.value;

            });



            formatSelect.addEventListener('change', () => {

                 // The quality slider only applies to JPEG and WebP formats

                if (formatSelect.value === 'image/png') {

                    qualityContainer.style.display = 'none';

                } else {

                    qualityContainer.style.display = 'block';

                }

            });



            widthInput.addEventListener('input', () => {

                if (aspectRatioCheckbox.checked) {

                    const newHeight = Math.round(widthInput.value / originalAspectRatio);

                    if (!isNaN(newHeight)) heightInput.value = newHeight;

                }

            });



            heightInput.addEventListener('input', () => {

                 if (aspectRatioCheckbox.checked) {

                    const newWidth = Math.round(heightInput.value * originalAspectRatio);

                    if (!isNaN(newWidth)) widthInput.value = newWidth;

                }

            });



            // --- CORE LOGIC ---

            function optimizeImage() {

                const width = parseInt(widthInput.value, 10);

                const height = parseInt(heightInput.value, 10);

                const format = formatSelect.value;

                const quality = parseFloat(qualitySlider.value);



                if (isNaN(width) || isNaN(height) || width <= 0 || height <= 0) {

                    alert('Please enter valid width and height values.');

                    return;

                }



                // Create an in-memory canvas to perform the drawing

                const canvas = document.createElement('canvas');

                canvas.width = width;

                canvas.height = height;

                const ctx = canvas.getContext('2d');



                // Draw the source image onto the canvas, resizing it in the process

                ctx.drawImage(sourceImage, 0, 0, width, height);



                // Get the result as a data URL

                // The toDataURL method accepts format and quality parameters

                const dataUrl = canvas.toDataURL(format, (format !== 'image/png') ? quality : undefined);



                // Display the result

                resultImage.src = dataUrl;

                resultImage.classList.remove('hidden');

                placeholderText.classList.add('hidden');

                downloadLink.classList.remove('hidden');

                downloadLink.classList.add('flex');



                // Update download link

                const fileExtension = format.split('/')[1];

                downloadLink.href = dataUrl;

                downloadLink.download = `optimized-image-${width}x${height}.${fileExtension}`;

                

                // Display file size info

                const fileSizeKB = (dataUrl.length * (3/4) / 1024).toFixed(2);

                resultInfo.textContent = `Dimensions: ${width}x${height} | Size: ~${fileSizeKB} KB`;

            }

            

            // Initialize Lucide icons

            lucide.createIcons();

        });

    </script>

</body>

</html>